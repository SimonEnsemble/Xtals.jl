<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>crystals · Xtals.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/flux.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Xtals.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Xtals</a></li><li><a class="tocitem" href="../globals/">globals</a></li><li><a class="tocitem" href="../matter/">matter</a></li><li><a class="tocitem" href="../box/">boxes</a></li><li class="is-active"><a class="tocitem" href>crystals</a><ul class="internal"><li><a class="tocitem" href="#Reading-in-a-Crystal-Structure-File"><span>Reading in a Crystal Structure File</span></a></li><li><a class="tocitem" href="#Fixing-Atom-Species-Labels"><span>Fixing Atom Species Labels</span></a></li><li><a class="tocitem" href="#Converting-the-Coordinates-to-Cartesian-Space"><span>Converting the Coordinates to Cartesian Space</span></a></li><li><a class="tocitem" href="#Creating-a-Super-Cell"><span>Creating a Super-Cell</span></a></li><li><a class="tocitem" href="#Finding-Other-Properties"><span>Finding Other Properties</span></a></li><li><a class="tocitem" href="#Assigning-New-Charges"><span>Assigning New Charges</span></a></li><li><a class="tocitem" href="#Writing-Crystal-Files"><span>Writing Crystal Files</span></a></li><li class="toplevel"><a class="tocitem" href="#Detailed-Docs"><span>Detailed Docs</span></a></li></ul></li><li><a class="tocitem" href="../distance/">computing distances</a></li><li><a class="tocitem" href="../bonds/">bonding</a></li><li><a class="tocitem" href="../visualization/">visualization</a></li><li><a class="tocitem" href="../pytools/">XtalsPyTools</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>crystals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>crystals</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SimonEnsemble/Xtals.jl/blob/master/docs/src/crystal.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Crystals"><a class="docs-heading-anchor" href="#Crystals">Crystals</a><a id="Crystals-1"></a><a class="docs-heading-anchor-permalink" href="#Crystals" title="Permalink"></a></h1><p><code>Xtals.jl</code> maintains a data structure <a href="#Xtals.Crystal"><code>Crystal</code></a> that stores information about a crystal structure file.</p><h2 id="Reading-in-a-Crystal-Structure-File"><a class="docs-heading-anchor" href="#Reading-in-a-Crystal-Structure-File">Reading in a Crystal Structure File</a><a id="Reading-in-a-Crystal-Structure-File-1"></a><a class="docs-heading-anchor-permalink" href="#Reading-in-a-Crystal-Structure-File" title="Permalink"></a></h2><p>Currently, the crystal structure file reader accepts <code>.cif</code> and <code>.cssr</code> file formats.  <code>Xtals.jl</code> looks for the crystal structure files in <code>rc[:paths][:crystals]</code> which is by default <code>./data/crystals</code> (relative to <code>pwd()</code> at module loading).  By typing <code>rc[:paths][:crystals] = &quot;my_crystal_dir&quot;</code>, <code>Xtals.jl</code> now looks for the crystal structure file in <code>my_crystal_dir</code>. The files can be read as:</p><pre><code class="language-julia hljs">xtal = Crystal(&quot;IRMOF-1.cif&quot;)       # The crystal reader stores the information in xtal
xtal.name                           # The name of the crystal structure file
xtal.box                            # The unit cell information
xtal.atoms                          # The atom coordinates (in fractional space) and the atom identities
xtal.charges                        # The charge magnitude and coordinates (in fractional space)
xtal.bonds                          # Bonding information in the structure. By default this is an empty graph,
                                    #  but use `read_bonds_from_file=true` argument in `Crystal` to read from crystal structure file
xtal.symmetry                       # Symmetry information of the crystal. By default converts the symmetry to P1 symmetry.
                                    #  Use `convert_to_p1=false` argument in `Crystal` to keep original symmetry</code></pre><h2 id="Fixing-Atom-Species-Labels"><a class="docs-heading-anchor" href="#Fixing-Atom-Species-Labels">Fixing Atom Species Labels</a><a id="Fixing-Atom-Species-Labels-1"></a><a class="docs-heading-anchor-permalink" href="#Fixing-Atom-Species-Labels" title="Permalink"></a></h2><p>Often, the atoms species are appended by numbers.  This messes with the internal workings of <code>Xtals.jl</code>. To circumvent this problem, the function <a href="#Xtals.strip_numbers_from_atom_labels!"><code>strip_numbers_from_atom_labels!</code></a> removes the appended numbers. It is important to use this function prior to GCMC or Henry coefficient calculations and bond inference operations.</p><pre><code class="language-julia hljs">xtal = Crystal(&quot;IRMOF-1.cif&quot;, species_col=[&quot;_atom_site_label&quot;])
xtal.atoms.species[1]
# output
:Zn1</code></pre><pre><code class="language-julia hljs">strip_numbers_from_atom_labels!(xtal)
xtal.atoms.species[1]
# output
:Zn</code></pre><h2 id="Converting-the-Coordinates-to-Cartesian-Space"><a class="docs-heading-anchor" href="#Converting-the-Coordinates-to-Cartesian-Space">Converting the Coordinates to Cartesian Space</a><a id="Converting-the-Coordinates-to-Cartesian-Space-1"></a><a class="docs-heading-anchor-permalink" href="#Converting-the-Coordinates-to-Cartesian-Space" title="Permalink"></a></h2><p>The coordinates of the <a href="#Xtals.Crystal"><code>Crystal</code></a>&#39;s <a href="../matter/#Xtals.Atoms"><code>Atoms</code></a> are stored in <a href="../matter/#Xtals.Frac"><code>Frac</code></a>tional coordinates.  If one needs to analyze the <a href="../matter/#Xtals.Cart"><code>Cart</code></a>esian coordinates of the <a href="#Xtals.Crystal"><code>Crystal</code></a>, that can be done by using the unit cell (<a href="../box/#Xtals.Box"><code>Box</code></a>) information.</p><pre><code class="language-julia hljs">xtal.atoms.coords.xf                                    # array of fractional coordinates
cart_coords = xtal.box.f_to_c * xtal.atoms.coords.xf    # array of cartesian coordinates</code></pre><h2 id="Creating-a-Super-Cell"><a class="docs-heading-anchor" href="#Creating-a-Super-Cell">Creating a Super-Cell</a><a id="Creating-a-Super-Cell-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-Super-Cell" title="Permalink"></a></h2><p>For many simulations, one needs to replicate the unit cell multiple times to create a bigger super-cell. This is done with <a href="#Xtals.replicate"><code>replicate</code></a>:</p><pre><code class="language-julia hljs">super_xtal = replicate(xtal, (2,2,2))       # Replicates the original unit cell once in each dimension
xtal.atoms.n, super_xtal.atoms.n
# output
(424, 3392)</code></pre><h2 id="Finding-Other-Properties"><a class="docs-heading-anchor" href="#Finding-Other-Properties">Finding Other Properties</a><a id="Finding-Other-Properties-1"></a><a class="docs-heading-anchor-permalink" href="#Finding-Other-Properties" title="Permalink"></a></h2><pre><code class="language-julia hljs">rho = crystal_density(xtal)         # Crystal density of the crystal in kg/m^2
mw = molecular_weight(xtal)         # The molecular weight of the unit cell in amu
formula = empirical_formula(xtal)   # The irreducible chemical formula of the crystal</code></pre><h2 id="Assigning-New-Charges"><a class="docs-heading-anchor" href="#Assigning-New-Charges">Assigning New Charges</a><a id="Assigning-New-Charges-1"></a><a class="docs-heading-anchor-permalink" href="#Assigning-New-Charges" title="Permalink"></a></h2><p>If the structure file does not contain partial charges, we provide methods to assign new <a href="../matter/#Xtals.Charges"><code>Charges</code></a> to the <a href="#Xtals.Crystal"><code>Crystal</code></a>.</p><pre><code class="language-julia hljs">species_to_charge = Dict(:Zn =&gt; 2.0, :C =&gt; 0.0, :H =&gt; 0.0, :O =&gt; -0.61538)  # This method assigns a static charge to atom species
charged_xtal = assign_charges(xtal, species_to_charge, 1e-3)                # This function creates a new charged `Crystal` object.
                                                                            #   The function checks for charge neutrality with a tolerance of 1e-3
new_charges = Charges(zeros(xtal.atoms.n), xtal.atoms.coords)
other_charged_xtal = Crystal(xtal.name, xtal.box, xtal.atoms,               # Here we create a new `Charges` object using an array of new charges.
                             new_charges, xtal.bonds, xtal.symmetry)        #   The number of charges in the array has to be equal to the number of atoms
                                                                            #   and finally a new `Crystal` object is manually created</code></pre><h2 id="Writing-Crystal-Files"><a class="docs-heading-anchor" href="#Writing-Crystal-Files">Writing Crystal Files</a><a id="Writing-Crystal-Files-1"></a><a class="docs-heading-anchor-permalink" href="#Writing-Crystal-Files" title="Permalink"></a></h2><p>We provide methods to write both <code>.xyz</code> and <code>.cif</code> files.</p><pre><code class="language-julia hljs">write_cif(xtal, &quot;my_new_cif_file.cif&quot;)      # Stored in the current directory
write_xyz(xtal, &quot;my_new_xyz_file.xyz&quot;)      # stored in the current directory</code></pre><h1 id="Detailed-Docs"><a class="docs-heading-anchor" href="#Detailed-Docs">Detailed Docs</a><a id="Detailed-Docs-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-Docs" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="Xtals.Crystal" href="#Xtals.Crystal"><code>Xtals.Crystal</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">crystal = Crystal(filename;
    check_neutrality=true, net_charge_tol=1e-4,
    check_overlap=true, convert_to_p1=true,
    read_bonds_from_file=false, wrap_coords=true,
    include_zero_charges=true,
    remove_duplicates=false,
    species_col=[&quot;_atom_site_type_symbol&quot;, &quot;_atom_site_label&quot;]
    ) # read from file

crystal = Crystal(name, box, atoms, charges) # construct from matter, no bonds, P1-symmetry assumed</code></pre><p>Read a crystal structure file (.cif or .cssr) and populate a <code>Crystal</code> data structure, or construct a <code>Crystal</code> data structure directly.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code>: the name of the crystal structure file (include &quot;.cif&quot; or &quot;.cssr&quot;) read from <code>PATH_TO_CRYSTALS</code>.</li><li><code>check_neutrality::Bool</code>: check for charge neutrality</li><li><code>net_charge_tol::Float64</code>: when checking for charge neutrality, throw an error if the absolute value of the net charge is larger than this value.</li><li><code>check_overlap::Bool</code>: throw an error if overlapping atoms are detected.</li><li><code>convert_to_p1::Bool</code>: If the structure is not in P1 it will be converted to   P1 symmetry using the symmetry rules from the <code>_symmetry_equiv_pos_as_xyz</code> list in the .cif file.   (We do not use the space groups name to look up symmetry rules).</li><li><code>read_bonds_from_file::Bool</code>: Whether or not to read bonding information from   cif file. If false, the bonds can be inferred later. note that, if the crystal is not in P1 symmetry, we cannot <em>both</em> read bonds and convert to P1 symmetry.</li><li><code>wrap_coords::Bool</code>: if <code>true</code>, enforce that fractional coords of atoms and charges are in [0,1]³ by mod(x, 1)</li><li><code>include_zero_charges::Bool</code>: if <code>false</code>, do not include in <code>crystal.charges</code> atoms which have zero charges, in order to speed up the electrostatic calculations.   If <code>true,</code> include the atoms in <code>crystal.charges</code> that have zero charge, ensuring that the number of atoms is equal to the number of charges and that <code>crystal.charges.coords.xf</code> and <code>crystal.atoms.coords.xf</code> are the same.</li><li><code>remove_duplicates::Bool</code>: remove duplicate atoms and charges. an atom is duplicate only if it is the same species.</li><li><code>species_col::Array{String}</code>: which column to use for species identification for <code>crystal.atoms.species</code>. we use a priority list:   we check for the first entry of <code>species_col</code> in the .cif file; if not present, we then use the second entry, and so on.</li><li><code>infer_bonds::Bool</code>: if true, bonds are inferred automatically. If set, must specify <code>periodic_boundaries</code>. By default, bonds are not inferred.</li><li><code>periodic_boundaries::Union{Bool, Missing}</code>: use with <code>infer_bonds</code> to specify treatment of the unit cell boundary.  Set <code>true</code> to treat the unit cell edge as a periodic boundary (allow bonds across it); set <code>false</code> to restrict bonding to within the local unit cell. By default, no bonds are inferred.</li><li><code>absolute_path::Bool</code>: set <code>true</code> to load from an absolute path instead of the default path stored in <code>rc[:paths][:crystals]</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>crystal::Crystal</code>: A crystal containing the crystal structure information</li></ul><p><strong>Attributes</strong></p><ul><li><code>name::AbstractString</code>: name of crystal structure</li><li><code>box::Box</code>: unit cell (Bravais Lattice)</li><li><code>atoms::Atoms</code>: list of Atoms in crystal unit cell</li><li><code>charges::Charges</code>: list of point charges in crystal unit cell</li><li><code>bonds::MetaGraph</code>: Unweighted, undirected graph showing all of the atoms   that are bonded within the crystal</li><li><code>symmetry::SymmetryInfo</code>: symmetry inforomation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/crystal.jl#L35-L81">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.SymmetryInfo" href="#Xtals.SymmetryInfo"><code>Xtals.SymmetryInfo</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SymmetryInfo(symmetry, space_group, is_p1)</code></pre><p><strong>Attributes</strong></p><ul><li><code>operations::Array{Function, 2}</code>: 2D array of anonymous functions that represent   the symmetry operations. If the structure is in P1 there will be one   symmetry operation.</li><li><code>space_group::AbstractString</code>: The name of the space group. This is stored   so that it can be written out again in the write_cif function. The space   group is not used to verify the symmetry rules.</li><li><code>is_p1::Bool</code>: Stores whether the crystal is currently in P1 symmetry.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/crystal.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.strip_numbers_from_atom_labels!" href="#Xtals.strip_numbers_from_atom_labels!"><code>Xtals.strip_numbers_from_atom_labels!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">strip_numbers_from_atom_labels!(crystal)</code></pre><p>Strip numbers from labels for <code>crystal.atoms</code>. Precisely, for <code>atom</code> in <code>crystal.atoms</code>, find the first number that appears in <code>atom</code>. Remove this number and all following characters from <code>atom</code>. e.g. C12 –&gt; C      Ba12A_3 –&gt; Ba</p><p><strong>Arguments</strong></p><ul><li><code>crystal::Crystal</code>: The crystal containing the crystal structure information</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/crystal.jl#L610-L621">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.replicate" href="#Xtals.replicate"><code>Xtals.replicate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">new_box = replicate(original_box, repfactors)</code></pre><p>Replicates a <code>Box</code> in positive directions to construct a new <code>Box</code> representing a supercell. The <code>original_box</code> is replicated according to the factors in <code>repfactors</code>. Note <code>replicate(original_box, repfactors=(1, 1, 1))</code> returns same <code>Box</code>. The new fractional coordinates as described by <code>f_to_c</code> and <code>c_to_f</code> still ∈ [0, 1].</p><p><strong>Arguments</strong></p><ul><li><code>original_box::Box</code>: The box that you want to replicate</li><li><code>repfactors::Tuple{Int, Int, Int}</code>: The factor you want to replicate the box by</li></ul><p><strong>Returns</strong></p><ul><li><code>box::Box</code>: Fully formed Box object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/box.jl#L133-L147">source</a></section><section><div><pre><code class="nohighlight hljs">replicated_crystal = replicate(crystal, repfactors)</code></pre><p>replicate the atoms and charges in a <code>Crystal</code> in positive directions to construct a new <code>Crystal</code>. Note <code>replicate(crystal, (1, 1, 1))</code> returns the same <code>Crystal</code>. the fractional coordinates will be rescaled to be in [0, 1].</p><p><strong>arguments</strong></p><ul><li><code>crystal::Crystal</code>: The crystal to replicate</li><li><code>repfactors::Tuple{Int, Int, Int}</code>: The factors by which to replicate the crystal structure in each crystallographic direction (a, b, c).</li></ul><p><strong>returns</strong></p><ul><li><code>replicated_frame::Crystal</code>: replicated crystal</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/crystal.jl#L506-L519">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.molecular_weight" href="#Xtals.molecular_weight"><code>Xtals.molecular_weight</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">mass_of_crystal = molecular_weight(crystal)</code></pre><p>Calculates the molecular weight of a unit cell of the crystal in amu using information stored in <code>data/atomicmasses.csv</code>.</p><p><strong>Arguments</strong></p><ul><li><code>crystal::Crystal</code>: The crystal containing the crystal structure information</li></ul><p><strong>Returns</strong></p><ul><li><code>mass_of_crystal::Float64</code>: The molecular weight of a unit cell of the crystal in amu</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/crystal.jl#L670-L681">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.crystal_density" href="#Xtals.crystal_density"><code>Xtals.crystal_density</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ρ = crystal_density(crystal) # kg/m²</code></pre><p>Compute the crystal density of a crystal. Pulls atomic masses from <a href="@ref"><code>read_atomic_masses</code></a>.</p><p><strong>Arguments</strong></p><ul><li><code>crystal::Crystal</code>: The crystal containing the crystal structure information</li></ul><p><strong>Returns</strong></p><ul><li><code>ρ::Float64</code>: The crystal density of a crystal in kg/m³</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/crystal.jl#L693-L703">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.empirical_formula" href="#Xtals.empirical_formula"><code>Xtals.empirical_formula</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">formula = empirical_formula(crystal, verbose=false)</code></pre><p>Find the irreducible chemical formula of a crystal structure.</p><p><strong>Arguments</strong></p><ul><li><code>crystal::Crystal</code>: The crystal containing the crystal structure information</li><li><code>verbose::Bool</code>: If <code>true</code>, will print the chemical formula as well</li></ul><p><strong>Returns</strong></p><ul><li><code>formula::Dict{Symbol, Int}</code>: A dictionary with the irreducible chemical formula of a crystal structure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/crystal.jl#L630-L641">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.assign_charges" href="#Xtals.assign_charges"><code>Xtals.assign_charges</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">crystal_with_charges = assign_charges(crystal, species_to_charge, net_charge_tol=1e-5)</code></pre><p>assign charges to the atoms present in the crystal based on atom type. pass a dictionary <code>species_to_charge</code> that maps atomic species to a charge.</p><p>if the crystal already has charges, the charges are removed and new charges are added. a warning is thrown if this is the case.</p><p>checks for charge neutrality in the end.</p><p>returns a new crystal.</p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">species_to_charge = Dict(:Ca =&gt; 2.0, :C =&gt; 1.0, :H =&gt; -1.0)
crystal_with_charges = assign_charges(crystal, species_to_charge, 1e-7)
crystal_with_charges = assign_charges(crystal, species_to_charge) # tol 1e-5 default</code></pre><p><strong>Arguments</strong></p><ul><li><code>crystal::Crystal</code>: the crystal</li><li><code>species_to_charge::Dict{Symbol, Float64}</code>: a dictionary that maps atomic species to charge</li><li><code>net_charge_tol::Float64</code>: the net charge tolerated when asserting charge neutrality of</li></ul><p>the resulting crystal</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/crystal.jl#L962-L987">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.write_cif" href="#Xtals.write_cif"><code>Xtals.write_cif</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_cif(crystal, filename; fractional_coords=true, number_atoms=true)
write_cif(crystal) # writes to file crystal.name[.cif]</code></pre><p>Write a <code>crystal::Crystal</code> to a .cif file.</p><p><strong>arguments</strong></p><ul><li><code>crystal::Crystal</code>: crystal to write to file</li><li><code>filename::String</code>: the filename of the <code>.cif</code> file. if &quot;.cif&quot; is not included as an extension, it will automatically be appended to the <code>filename</code> string.</li><li><code>fractional_coords::Bool=true</code>: write the coordinates of the atoms as fractional coords if <code>true</code>. if <code>false</code>, write Cartesian coords.</li><li><code>number_atoms::Bool=true</code>: write the atoms as &quot;C1&quot;, &quot;C2&quot;, &quot;C3&quot;, ..., &quot;N1&quot;, &quot;N2&quot;, ... etc. to give each atom a unique identifier</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/crystal.jl#L771-L782">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.write_xyz" href="#Xtals.write_xyz"><code>Xtals.write_xyz</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_xyz(atoms, filename; comment=&quot;&quot;)
write_xyz(crystal; comment=&quot;&quot;, center_at_origin=false)
write_xyz(molecules, box, filename; comment=&quot;&quot;) # fractional
write_xyz(molecules, box, filename; comment=&quot;&quot;) # Cartesian</code></pre><p>write atoms to an .xyz file.</p><p><strong>Arguments</strong></p><ul><li><code>atoms::Atoms</code>: the set of atoms.</li><li><code>filename::AbstractString</code>: the filename (absolute path) of the .xyz file. (&quot;.xyz&quot; appended automatically</li></ul><p>if the extension is not provided.)</p><ul><li><code>comment::AbstractString</code>: comment if you&#39;d like to write to the file.</li><li><code>center_at_origin::Bool</code>: (for crystal only) if <code>true</code>, translate all coords such that the origin is the center of the unit cell.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/misc.jl#L41-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.read_xyz" href="#Xtals.read_xyz"><code>Xtals.read_xyz</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">atoms = read_xyz(&quot;molecule.xyz&quot;)</code></pre><p>read a list of atomic species and their corresponding coordinates from an .xyz file.</p><p><strong>Arguments</strong></p><ul><li><code>filename::AbstractString</code>: the path to and filename of the .xyz file</li></ul><p><strong>Returns</strong></p><ul><li><code>atoms::Atoms{Cart}</code>: the set of atoms read from the .xyz file.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/misc.jl#L14-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Xtals.read_mol" href="#Xtals.read_mol"><code>Xtals.read_mol</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">atoms, bonds = read_mol(&quot;molecule.mol&quot;)</code></pre><p>read a <code>.mol</code> file, which contains info about both atoms and bonds. see <a href="https://chem.libretexts.org/Courses/University_of_Arkansas_Little_Rock/ChemInformatics_(2017)%3A_Chem_4399%2F%2F5399/2.2%3A_Chemical_Representations_on_Computer%3A_Part_II/2.2.2%3A_Anatomy_of_a_MOL_file">here</a> for the anatomy of a <code>.mol</code> file.</p><p><strong>Arguments</strong></p><ul><li><code>filename::AbstractString</code>: the path to and filename of the .mol file (must pass extension)</li></ul><p><strong>Returns</strong></p><ul><li><code>atoms::Atoms{Cart}</code>: the set of atoms read from the <code>.mol</code> file.</li><li><code>bonds::MetaGraph</code>: the bonding graph of the atoms read from the <code>.mol</code> file.</li><li><code>bond_types::Array{Int, 1}</code>: the array of bond types.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/Xtals.jl/blob/db46fb989b85af6347a96b86c1cbfd6bf5bbb87c/src/misc.jl#L70-L83">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../box/">« boxes</a><a class="docs-footer-nextpage" href="../distance/">computing distances »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 8 October 2022 20:34">Saturday 8 October 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
